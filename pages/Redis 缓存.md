- What
- Why
- How
	- 可能出现的问题
		- 缓存穿透
			- 来源
				- 指缓存和数据库中都没有的数据，被用户不断发起请求查询。由于缓存是不命中时被动写的，并且出于容错考虑，如果从存储层查不到数据则不写入缓存，故这个不存在的数据的每次请求都会去存储层查询，失去了缓存的意义
			- 解决方案
				- 接口层增加校验，如用户鉴权校验，id 做基础校验（id<=0 的直接拦截
				- 从缓存和数据库都取不到的数据，可以将 key-value 对写为 key-null，缓存有效的时间可以设置短点，比如 30 秒（设置太长会导致正常情况也没法使用）。这样可以防止攻击者反复用同一个 id 暴力攻击
				- [[布隆过滤器]]
		- 缓存击穿
			- 来源
				- 指**缓存中没有但数据库中有的数据**（一般是缓存时间到期）。这时由于并发用户特别多，同时读缓存没读到数据，又同时去数据库去取数据，引起数据库压力瞬间增大，造成过大压力
			- 解决方案
				- 设置热点数据永远不过期
				- 接口限流与[[熔断]]、[[降级]]
					- 重要的接口一定要做好限流策略，防止用户恶意刷接口
					- TODO 同时要做好降级准备，当某些接口不可用时，进行熔断，快速失败返回机制
				- 加互斥锁
		- 缓存雪崩
			- 来源
				- 指缓存中数据大批量地同时过期，而查询数据量巨大，从而引起数据库压力过大甚至宕机
			- **缓存击穿** VS **缓存雪崩**
				- 前者指并发查询同一条数据
				- 后者指不同数据都过期了，从而查数据库
			- 解决方案
				- 设置热点数据永远不过期
				- 缓存数据的过期时间设置随机，防止同一时间大量数据过期
				- 如果缓存数据库是分布式部署，将热点数据均匀分布在不同的缓存数据库中
		- 缓存污染
- How Good
- Refs
- See Also